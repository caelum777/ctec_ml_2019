---
title: "Clase 6"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Tarea 6.
# Metodos supervisados 2

Librerias
```{r}
library(caTools)
library(rpart)
library(dplyr)
library(ggplot2)
#..........Librerias de los modelos
```

1. Desarolle el Analisis del Problema
```{r}
# Construya el análisis del problema


# Los datos se obtienen mediante el  parte oficial de tr?nsito que realiza la Direcci?n General de Polic?a de Tr?nsito al presentarse un accidente, los cuales ingresan a la base de datos de dos formas (hand held y papel). Debido a que parte de la labor principal de la Instituci?n es salvar vidas, y por los recursos limitados que existen, se trabaja solo con accidentes con heridos y/o fallecidos; y no se trabaja con accidentes que presentan solo da?os materiales. Adem?s, posteriormente inicia el proceso de limpieza, correcci?n de inconsistencias, validaci?n de algunas variables,  georeferenciaci?n de los accidentes, entre otros.


#Accidente con v?ctima se refiere cuando en el accidente de tr?nsito al menos uno de los participantes resulto: herido leve, grave o fallecido.

#Para m?s informaci?n revisar la metodolog?a del documento Memoria estad?stica de accidentes de tr?nsito con v?ctimas.Periodo 2012-2014.

```
Fuente del dataset:
http://datosabiertos.csv.go.cr/dashboards/19683/accidentes/

1. Cargue el archivo nombre.csv en una variable

```{r}
accidentes <- read.csv(file = "temp_5571830814335439232.csv", header = TRUE, sep = ",", strip.white = TRUE, stringsAsFactors = TRUE,
                       colClasses = c("NULL","factor", "factor", "factor", "NULL", "factor", "integer", "factor", "factor", "factor", "factor", "factor", "NULL", "NULL", "NULL"))

# Cambiamos los headers por unos más legibles
names(accidentes) <- c("rol", "lesion", "edad", "sexo", "anno", "mes", "dia", "provincia", "canton", "distrito")

# Cambiamos el tipo de lesion por Ileso o No Ileso
levels(accidentes$lesion) <- c("No Ileso", "No Ileso", "Ileso", "No Ileso")

# Cambiamos nombres de provincias por unos mas legibles
levels(accidentes$provincia) <- c("Alajuela", "Cartago", "Guanacaste", "Heredia", "Limon", "Puntarenas", "San Jose")

# Cambiamos nombres de dia por unos mas legibles
levels(accidentes$dia) <- c("Domingo", "Jueves", "Lunes", "Martes", "Miercoles", "Sabado", "Viernes")
accidentes$dia <- factor(accidentes$dia, order = TRUE, 
                         levels = c("Lunes", "Martes", "Miercoles", "Jueves", "Viernes", "Sabado", "Domingo"))
```

 
2. Desarolle el Entendimiento de los Datos

1. Rol	
2. Tipo de lesión	
3. Edad
3. Sexo
4. Año
5. Mes
6. Día
7. Provincia
8. Cantón
9. Distrito

3. Utilizando barplot cree un grafico de los atributos del dataset, observe las correlaciones entre atributos


Parece que la variable rol es la más significativa para determinar si sale ileso o no de un accidente

```{r}
glimpse(accidentes)

tbl <- with(accidentes, table(lesion, provincia))
ggplot(as.data.frame(tbl), aes(factor(provincia), Freq, fill = lesion)) +     
  geom_col(position = 'dodge')

tbl <- with(accidentes, table(lesion, sexo))
ggplot(as.data.frame(tbl), aes(factor(sexo), Freq, fill = lesion)) +     
  geom_col(position = 'dodge')

tbl <- with(accidentes, table(lesion, dia))
ggplot(as.data.frame(tbl), aes(factor(dia), Freq, fill = lesion)) +     
  geom_col(position = 'dodge')

tbl <- with(accidentes, table(lesion, rol))
ggplot(as.data.frame(tbl), aes(factor(rol), Freq, fill = lesion)) +     
  geom_col(position = 'dodge') +
  coord_flip()
```


4. Realice al menos 5 modelos de los observados en clase
```{r}
# Escriba su c?digo aqui
```

5. Evaluaci?n de los modelos
```{r}
# Escriba su c?digo aqui

```


6. Desarolle al menos 5 conclusiones sobre las clasificaciones de los modelos



